#include "LedControlMS.h"
#include "OneWire.h"
/*
 pin 12 is connected to the DataIn 
 pin 11 is connected to the CLK 
 pin 10 is connected to CS
 pin 9 DS18B20 with 4.7K resistor

 while get temp from sensors , we get average 4 times
 */
LedControl lc=LedControl(12,11,10,2); // 2 - two 8x8 led matrix
OneWire  ds(9);  

byte out[8]=    {B00111100,B01000010,B10010101,B10010001,B10010001, B10010101, B01000010, B00111100}; // smile on LED 1, while we get temp from street
byte numbersT[100][8]= {
  {B00000000, B00000000, B00000000, B00000000, B00000000, B11111111, B10000001, B11111111},//0
  {B00000000, B00000000, B00000000, B00000000, B00000000, B00000100, B00000010, B11111111},//1
  {B00000000, B00000000, B00000000, B00000000, B00000000, B11110011, B10001001, B10000111},//2
  {B00000000, B00000000, B00000000, B00000000, B00000000, B10001001, B10001001, B11111111},//3
  {B00000000, B00000000, B00000000, B00000000, B00000000, B00001111, B00001000, B11111111},//4
  {B00000000, B00000000, B00000000, B00000000, B00000000, B10001111, B10001001, B11111001},//5
  {B00000000, B00000000, B00000000, B00000000, B00000000, B11111111, B10001001, B11111001},//6
  {B00000000, B00000000, B00000000, B00000000, B00000000, B11110001, B00001001, B00000111},//7
  {B00000000, B00000000, B00000000, B00000000, B00000000, B11111111, B10001001, B11111111},//8
  {B00000000, B00000000, B00000000, B00000000, B00000000, B10001111, B10001001, B11111111},//9
  {B00000000, B00000100, B00000010, B11111111, B00000000, B11111111, B10000001, B11111111},//10
  {B00000000, B00000100, B00000010, B11111111, B00000000, B00000100, B00000010, B11111111},//11
  {B00000000, B00000100, B00000010, B11111111, B00000000, B11110011, B10001001, B10000111},//12
  {B00000000, B00000100, B00000010, B11111111, B00000000, B10001001, B10001001, B11111111},//13
  {B00000000, B00000100, B00000010, B11111111, B00000000, B00001111, B00001000, B11111111},//14
  {B00000000, B00000100, B00000010, B11111111, B00000000, B10001111, B10001001, B11111001},//15
  {B00000000, B00000100, B00000010, B11111111, B00000000, B11111111, B10001001, B11111001},//16
  {B00000000, B00000100, B00000010, B11111111, B00000000, B11110001, B00001001, B00000111},//17
  {B00000000, B00000100, B00000010, B11111111, B00000000, B11111111, B10001001, B11111111},//18
  {B00000000, B00000100, B00000010, B11111111, B00000000, B10001111, B10001001, B11111111},//19
  {B00000000, B11110011, B10001001, B10000111, B00000000, B11111111, B10000001, B11111111},//20
  {B00000000, B11110011, B10001001, B10000111, B00000000, B00000100, B00000010, B11111111},//21
  {B00000000, B11110011, B10001001, B10000111, B00000000, B11110011, B10001001, B10000111},//22
  {B00000000, B11110011, B10001001, B10000111, B00000000, B10001001, B10001001, B11111111},//23
  {B00000000, B11110011, B10001001, B10000111, B00000000, B00001111, B00001000, B11111111},//24
  {B00000000, B11110011, B10001001, B10000111, B00000000, B10001111, B10001001, B11111001},//25
  {B00000000, B11110011, B10001001, B10000111, B00000000, B11111111, B10001001, B11111001},//26
  {B00000000, B11110011, B10001001, B10000111, B00000000, B11110001, B00001001, B00000111},//27
  {B00000000, B11110011, B10001001, B10000111, B00000000, B11111111, B10001001, B11111111},//28
  {B00000000, B11110011, B10001001, B10000111, B00000000, B10001111, B10001001, B11111111},//29
  {B00000000, B10001001, B10001001, B11111111, B00000000, B11111111, B10000001, B11111111},//30
  {B00000000, B10001001, B10001001, B11111111, B00000000, B00000100, B00000010, B11111111},//31
  {B00000000, B10001001, B10001001, B11111111, B00000000, B11110011, B10001001, B10000111},//32 
  {B00000000, B10001001, B10001001, B11111111, B00000000, B10001001, B10001001, B11111111},//33
  {B00000000, B10001001, B10001001, B11111111, B00000000, B00001111, B00001000, B11111111},//34
  {B00000000, B10001001, B10001001, B11111111, B00000000, B10001111, B10001001, B11111001},//35
  {B00000000, B10001001, B10001001, B11111111, B00000000, B11111111, B10001001, B11111001},//36
  {B00000000, B10001001, B10001001, B11111111, B00000000, B11110001, B00001001, B00000111},//37
  {B00000000, B10001001, B10001001, B11111111, B00000000, B11111111, B10001001, B11111111},//38
  {B00000000, B10001001, B10001001, B11111111, B00000000, B10001111, B10001001, B11111111},//39
  {B00000000, B00001111, B00001000, B11111111, B00000000, B11111111, B10000001, B11111111},//40
  {B00000000, B00001111, B00001000, B11111111, B00000000, B00000100, B00000010, B11111111},//41
  {B00000000, B00001111, B00001000, B11111111, B00000000, B11110011, B10001001, B10000111},//42 
  {B00000000, B00001111, B00001000, B11111111, B00000000, B10001001, B10001001, B11111111},//43
  {B00000000, B00001111, B00001000, B11111111, B00000000, B00001111, B00001000, B11111111},//44
  {B00000000, B00001111, B00001000, B11111111, B00000000, B10001111, B10001001, B11111001},//45
  {B00000000, B00001111, B00001000, B11111111, B00000000, B11111111, B10001001, B11111001},//46
  {B00000000, B00001111, B00001000, B11111111, B00000000, B11110001, B00001001, B00000111},//47
  {B00000000, B00001111, B00001000, B11111111, B00000000, B11111111, B10001001, B11111111},//48
  {B00000000, B00001111, B00001000, B11111111, B00000000, B10001111, B10001001, B11111111},//49
  {B00000000, B10001111, B10001001, B11111001, B00000000, B11111111, B10000001, B11111111},//50
  {B00000000, B10001111, B10001001, B11111001, B00000000, B00000100, B00000010, B11111111},//51
  {B00000000, B10001111, B10001001, B11111001, B00000000, B11110011, B10001001, B10000111},//52 
  {B00000000, B10001111, B10001001, B11111001, B00000000, B10001001, B10001001, B11111111},//53
  {B00000000, B10001111, B10001001, B11111001, B00000000, B00001111, B00001000, B11111111},//54
  {B00000000, B10001111, B10001001, B11111001, B00000000, B10001111, B10001001, B11111001},//55
  {B00000000, B10001111, B10001001, B11111001, B00000000, B11111111, B10001001, B11111001},//56
  {B00000000, B10001111, B10001001, B11111001, B00000000, B11110001, B00001001, B00000111},//57
  {B00000000, B10001111, B10001001, B11111001, B00000000, B11111111, B10001001, B11111111},//58
  {B00000000, B10001111, B10001001, B11111001, B00000000, B10001111, B10001001, B11111111},//59
  {B00000000, B11111111, B10001001, B11111001, B00000000, B11111111, B10000001, B11111111},//60
  {B00000000, B11111111, B10001001, B11111001, B00000000, B00000100, B00000010, B11111111},//61
  {B00000000, B11111111, B10001001, B11111001, B00000000, B11110011, B10001001, B10000111},//62 
  {B00000000, B11111111, B10001001, B11111001, B00000000, B10001001, B10001001, B11111111},//63
  {B00000000, B11111111, B10001001, B11111001, B00000000, B00001111, B00001000, B11111111},//64
  {B00000000, B11111111, B10001001, B11111001, B00000000, B10001111, B10001001, B11111001},//65
  {B00000000, B11111111, B10001001, B11111001, B00000000, B11111111, B10001001, B11111001},//66
  {B00000000, B11111111, B10001001, B11111001, B00000000, B11110001, B00001001, B00000111},//67
  {B00000000, B11111111, B10001001, B11111001, B00000000, B11111111, B10001001, B11111111},//68
  {B00000000, B11111111, B10001001, B11111001, B00000000, B10001111, B10001001, B11111111},//69
  {B00000000, B11110001, B00001001, B00000111, B00000000, B11111111, B10000001, B11111111},//70
  {B00000000, B11110001, B00001001, B00000111, B00000000, B00000100, B00000010, B11111111},//71
  {B00000000, B11110001, B00001001, B00000111, B00000000, B11110011, B10001001, B10000111},//72 
  {B00000000, B11110001, B00001001, B00000111, B00000000, B10001001, B10001001, B11111111},//73
  {B00000000, B11110001, B00001001, B00000111, B00000000, B00001111, B00001000, B11111111},//74
  {B00000000, B11110001, B00001001, B00000111, B00000000, B10001111, B10001001, B11111001},//75
  {B00000000, B11110001, B00001001, B00000111, B00000000, B11111111, B10001001, B11111001},//76
  {B00000000, B11110001, B00001001, B00000111, B00000000, B11110001, B00001001, B00000111},//77
  {B00000000, B11110001, B00001001, B00000111, B00000000, B11111111, B10001001, B11111111},//78
  {B00000000, B11110001, B00001001, B00000111, B00000000, B10001111, B10001001, B11111111},//79
  {B00000000, B11111111, B10001001, B11111111, B00000000, B11111111, B10000001, B11111111},//80
  {B00000000, B11111111, B10001001, B11111111, B00000000, B00000100, B00000010, B11111111},//81
  {B00000000, B11111111, B10001001, B11111111, B00000000, B11110011, B10001001, B10000111},//82 
  {B00000000, B11111111, B10001001, B11111111, B00000000, B10001001, B10001001, B11111111},//83
  {B00000000, B11111111, B10001001, B11111111, B00000000, B00001111, B00001000, B11111111},//84
  {B00000000, B11111111, B10001001, B11111111, B00000000, B10001111, B10001001, B11111001},//85
  {B00000000, B11111111, B10001001, B11111111, B00000000, B11111111, B10001001, B11111001},//86
  {B00000000, B11111111, B10001001, B11111111, B00000000, B11110001, B00001001, B00000111},//87
  {B00000000, B11111111, B10001001, B11111111, B00000000, B11111111, B10001001, B11111111},//88
  {B00000000, B11111111, B10001001, B11111111, B00000000, B10001111, B10001001, B11111111},//89
  {B00000000, B10001111, B10001001, B11111111, B00000000, B11111111, B10000001, B11111111},//90
  {B00000000, B10001111, B10001001, B11111111, B00000000, B00000100, B00000010, B11111111},//91
  {B00000000, B10001111, B10001001, B11111111, B00000000, B11110011, B10001001, B10000111},//92 
  {B00000000, B10001111, B10001001, B11111111, B00000000, B10001001, B10001001, B11111111},//93
  {B00000000, B10001111, B10001001, B11111111, B00000000, B00001111, B00001000, B11111111},//94
  {B00000000, B10001111, B10001001, B11111111, B00000000, B10001111, B10001001, B11111001},//95
  {B00000000, B10001111, B10001001, B11111111, B00000000, B11111111, B10001001, B11111001},//96
  {B00000000, B10001111, B10001001, B11111111, B00000000, B11110001, B00001001, B00000111},//97
  {B00000000, B10001111, B10001001, B11111111, B00000000, B11111111, B10001001, B11111111},//98
  {B00000000, B10001111, B10001001, B11111111, B00000000, B10001111, B10001001, B11111111} //99
   };
            


void setup() {

  Serial.begin(9600);
  lc.shutdown(0,false);
  lc.setIntensity(0,2);
  lc.clearDisplay(0);
  lc.shutdown(1,false);
  lc.setIntensity(1,8);
  lc.clearDisplay(1);
  
}



/*
  This function lights up a some Leds in a row.
 The pattern will be repeated on every row.
 The pattern will blink along with the row-number.
 row number 4 (index==3) will blink 4 times etc.
 */
//void rows() {
//  for(int row=0;row<8;row++) {
//    delay(delaytime);
//    lc.setRow(0,row,B10100000);
//    delay(delaytime);
//    lc.setRow(0,row,(byte)0);
//    for(int i=0;i<row;i++) {
//      delay(delaytime);
//      lc.setRow(0,row,B10100000);
//      delay(delaytime);
//      lc.setRow(0,row,(byte)0);
//    }
//  }
//}

/*
  This function lights up a some Leds in a column.
 The pattern will be repeated on every column.
 The pattern will blink along with the column-number.
 column number 4 (index==3) will blink 4 times etc.
 */
//void columns() {
//  for(int col=0;col<8;col++) {
//    delay(delaytime);
//    lc.setColumn(0,col,B10100000);
//    delay(delaytime);
//    lc.setColumn(0,col,(byte)0);
//    for(int i=0;i<col;i++) {
//      delay(delaytime);
//      lc.setColumn(0,col,B10100000);
//      delay(delaytime);
//      lc.setColumn(0,col,(byte)0);
//    }
//  }
//}

/* 
 This function will light up every Led on the matrix.
 The led will blink along with the row-number.
 row number 4 (index==3) will blink 4 times etc.
 */
//void single() {
//  for(int row=0;row<8;row++) {
//    for(int col=0;col<8;col++) {
//      delay(delaytime);
//      lc.setLed(0,row,col,true);
//      delay(delaytime);
//      for(int i=0;i<col;i++) {
//        lc.setLed(0,row,col,false);
//        delay(delaytime);
//        lc.setLed(0,row,col,true);
//        delay(delaytime);
//      }
//    }
//  }
//}

//void test_out_tmp(){
//  byte i;
//  byte present = 0;
//  byte type_s;
//  byte data[12];
//  byte addr[8];
//  float celsius;
//
//  if ( !ds.search(addr)) {
//    Serial.println("No more addresses.");
//    Serial.println();
////    draw_err();
//    delay(250);  
//    ds.reset_search();
//    lc.clearDisplay(0);
//    delay(250);
//    return;
//  }
//  
//  Serial.print("ROM =");
//  for( i = 0; i < 8; i++) {
//    Serial.write(' ');
//    Serial.print(addr[i], HEX);
//  }
//
//  if (OneWire::crc8(addr, 7) != addr[7]) {
//      Serial.println("CRC is not valid!");
//      return;
//  }
//  Serial.println();
// 
//  // the first ROM byte indicates which chip
//  switch (addr[0]) {
//    case 0x10:
//      Serial.println("  Chip = DS18S20");  // or old DS1820
//      type_s = 1;
//      break;
//    case 0x28:
//      Serial.println("  Chip = DS18B20");
//      type_s = 0;
//      break;
//    case 0x22:
//      Serial.println("  Chip = DS1822");
//      type_s = 0;
//      break;
//    default:
//      Serial.println("Device is not a DS18x20 family device.");
//      return;
//  } 
//
//  ds.reset();
//  ds.select(addr);
//  ds.write(0x44);        // start conversion, with parasite power on at the end
//  
//  delay(1000);     // maybe 750ms is enough, maybe not
//  // we might do a ds.depower() here, but the reset will take care of it.
//  
//  present = ds.reset();
//  ds.select(addr);    
//  ds.write(0xBE);         // Read Scratchpad
//
//  Serial.print("  Data = ");
//  Serial.print(present, HEX);
//  Serial.print(" ");
//  for ( i = 0; i < 9; i++) {           // we need 9 bytes
//    data[i] = ds.read();
//    Serial.print(data[i], HEX);
//    Serial.print(" ");
//  }
//  Serial.print(" CRC=");
//  Serial.print(OneWire::crc8(data, 8), HEX);
//  Serial.println();
//
//  // Convert the data to actual temperature
//  // because the result is a 16 bit signed integer, it should
//  // be stored to an "int16_t" type, which is always 16 bits
//  // even when compiled on a 32 bit processor.
//  int16_t raw = (data[1] << 8) | data[0];
//  if (type_s) {
//    raw = raw << 3; // 9 bit resolution default
//    if (data[7] == 0x10) {
//      // "count remain" gives full 12 bit resolution
//      raw = (raw & 0xFFF0) + 12 - data[6];
//    }
//  } else {
//    byte cfg = (data[4] & 0x60);
//    // at lower res, the low bits are undefined, so let's zero them
//    if (cfg == 0x00) raw = raw & ~7;  // 9 bit resolution, 93.75 ms
//    else if (cfg == 0x20) raw = raw & ~3; // 10 bit res, 187.5 ms
//    else if (cfg == 0x40) raw = raw & ~1; // 11 bit res, 375 ms
//    //// default is 12 bit resolution, 750 ms conversion time
//  }
//  celsius = (float)raw / 16.0;
//  Serial.print("  Temperature = ");
//  Serial.print(celsius);
//  Serial.print(" Celsius, ");
//  
//}

void draw(int temp_room, bool positive, int number_room){ 
  if (number_room == 0){ 
   
  }

  if (number_room == 1){    
   
  }

  if (number_room == 2){ //street
   
  }
  
}

void loop() {
//humidity
byte numberH[5]=    {B00000001,B00000001,B00000001,B00000011,B00000001}; //1
byte plus_out[8]=    {B00000010,B00000111,B00000010,B00000000,B00000000, B00000000, B00000000, B00000000};
  
for (int j=0;  j<5 ; j++){
      lc.setColumn(0,j,numberH[j]);
}
//  for (int i=0; i<100 ; i++){ 
//    delay(600);
//    lc.clearDisplay(0);
//    for (int j=0;  j<8 ; j++){
//      lc.setRow(0,j,numbers[i][j]);
//    }
//  }

}
